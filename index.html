<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Road Trip Discoverer</title>
    
    <link rel="stylesheet" href="https://unpkg.com/@geoapify/geocoder-autocomplete@1.6.0/styles/minimal.css">

    <style>
        body { font-family: -apple-system, sans-serif; background: #f4f4f7; padding: 20px; display: flex; justify-content: center; }
        .card { background: white; padding: 25px; border-radius: 15px; width: 100%; max-width: 400px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .autocomplete-container { position: relative; margin-bottom: 20px; min-height: 45px; border: 1px solid #ddd; border-radius: 8px; }
        .travel-btn { width: 100%; padding: 15px; background: #007aff; color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
        label { font-size: 12px; color: #888; margin-bottom: 5px; display: block; }
    </style>
</head>
<body>

<div class="card">
    <h2>Where to?</h2>
    
    <label>FROM</label>
    <div id="origin-box" class="autocomplete-container"></div>
    
    <label>TO</label>
    <div id="destination-box" class="autocomplete-container"></div>
    
    <button class="travel-btn" onclick="startTrip()">Travel!</button>
</div>

<script defer src="https://unpkg.com/@geoapify/geocoder-autocomplete@1.6.0/dist/index.bundle.min.js"></script>

<script>
    // Replace with your key
    const KEY = "bb34a64a008b4c2f89ac485d4f09f7c7"; 
    let startLoc = "", endLoc = "";

    // This function checks every 500ms if the library has arrived
    const checkLibrary = setInterval(() => {
        if (typeof autocomplete !== 'undefined') {
            clearInterval(checkLibrary);
            initInputs();
        }
    }, 500);

    function initInputs() {
        const origin = new autocomplete.GeocoderAutocomplete(
            document.getElementById("origin-box"), KEY, { placeholder: "Start...", filter: {countrycode: ["my"]} }
        );
        const dest = new autocomplete.GeocoderAutocomplete(
            document.getElementById("destination-box"), KEY, { placeholder: "End...", filter: {countrycode: ["my"]} }
        );

        origin.on('select', (loc) => { if(loc) startLoc = loc.properties.formatted; });
        dest.on('select', (loc) => { if(loc) endLoc = loc.properties.formatted; });
    }

    function startTrip() {
        // Fallback: If the user typed manually without selecting from dropdown
        const manualStart = document.querySelector("#origin-box input")?.value;
        const manualEnd = document.querySelector("#destination-box input")?.value;

        const finalStart = startLoc || manualStart;
        const finalEnd = endLoc || manualEnd;

        if (!finalStart || !finalEnd) {
            alert("Please enter both locations!");
        } else {
            alert("Trip planned from " + finalStart + " to " + finalEnd);
        }
    }
</script>

</body>
</html>
