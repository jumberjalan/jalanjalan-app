<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>KL to Temerloh Stopovers</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.js"></script>

    <style>
        :root { --primary: #2c3e50; --accent: #e67e22; --bg: #f8f9fa; }
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; display: flex; flex-direction: column; height: 100vh; background: var(--bg); }
        
        header { background: var(--primary); color: white; padding: 15px; text-align: center; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        #main-container { display: flex; flex-direction: column; flex: 1; overflow: hidden; }
        #map { height: 50vh; width: 100%; z-index: 1; }
        #list { flex: 1; overflow-y: auto; padding: 15px; border-top: 2px solid #ddd; }

        /* Desktop Layout */
        @media (min-width: 768px) {
            #main-container { flex-direction: row; }
            #map { height: auto; flex: 2; }
            #list { flex: 1; max-width: 380px; border-top: none; border-left: 1px solid #ddd; }
        }

        .card { background: white; padding: 15px; margin-bottom: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: 0.2s; }
        .card:active { transform: scale(0.98); }
        .card h3 { margin: 0 0 5px 0; font-size: 18px; color: var(--primary); }
        .card p { margin: 0 0 12px 0; font-size: 14px; color: #666; line-height: 1.4; }
        
        .nav-btn { 
            display: inline-block; background: var(--accent); color: white; 
            text-decoration: none; padding: 10px 18px; border-radius: 8px; 
            font-size: 14px; font-weight: bold; text-align: center; width: 100%; box-sizing: border-box;
        }
    </style>
</head>
<body>

<header>KL âžœ Temerloh Travel Guide</header>

<div id="main-container">
    <div id="map"></div>
    <div id="list">
        <h2 style="font-size: 20px; margin-top: 0;">Top Stopovers</h2>
        
        <div class="card">
            <h3>Genting Sempah R&R</h3>
            <p>KM 21 Karak Highway. Clean toilets, Starbucks, McD, and fuel.</p>
            <a href="#" class="nav-btn" onclick="navigate(3.3508, 101.7836)">NAVIGATE</a>
        </div>

        <div class="card">
            <h3>Lemang To'ki (Bentong)</h3>
            <p>Famous for wood-fired Lemang and Ayam Bakar. A must-detour!</p>
            <a href="#" class="nav-btn" onclick="navigate(3.5235, 101.9164)">NAVIGATE</a>
        </div>

        <div class="card">
            <h3>Restoran Gobang Maju</h3>
            <p>The legendary Ikan Patin Tempoyak spot in Temerloh town.</p>
            <a href="#" class="nav-btn" onclick="navigate(3.4475, 102.4173)">NAVIGATE</a>
        </div>
    </div>
</div>

<script>
    // 1. Initialize Map
    var map = L.map('map', { zoomControl: false }).setView([3.35, 101.95], 10);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    L.control.zoom({ position: 'bottomright' }).addTo(map);

    // 2. Add Locate Me Button
    L.control.locate({
        position: 'topleft',
        keepCurrentZoomLevel: true,
        flyTo: true
    }).addTo(map);

    // 3. Add Markers
    var stops = [
        { name: "Genting Sempah", lat: 3.3508, lng: 101.7836 },
        { name: "Lemang To'ki", lat: 3.5235, lng: 101.9164 },
        { name: "Temerloh (Gobang Maju)", lat: 3.4475, lng: 102.4173 }
    ];

    stops.forEach(function(stop) {
        L.marker([stop.lat, stop.lng]).addTo(map).bindPopup("<b>" + stop.name + "</b>");
    });

    // 4. Smart Navigation Logic
    function navigate(lat, lng) {
        const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
        const isAndroid = /Android/i.test(navigator.userAgent);
        
        let url = `https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`;
        
        if (isIOS) {
            url = `maps://maps.apple.com/?daddr=${lat},${lng}`;
        } else if (isAndroid) {
            url = `google.navigation:q=${lat},${lng}`;
        }
        
        window.open(url, '_blank');
    }
</script>

</body>
</html>
